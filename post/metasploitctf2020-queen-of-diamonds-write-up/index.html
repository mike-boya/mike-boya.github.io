<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/mike-boya.github.io\/"
        },
        "articleSection" : "post",
        "name" : "Metasploit CTF 2020 - Queen Of Diamonds Write-Up",
        "headline" : "Metasploit CTF 2020 - Queen Of Diamonds Write-Up",
        "description" : "\u003ch2 id=\u0022intro\u0022\u003eIntro\u003c\/h2\u003e\n\u003cp\u003eMy team and I participated in the Metasploit CTF this past week and came in third place! I wanted to write up a solution for one of my favorite challenges.\u003c\/p\u003e\n\u003cp\u003eSpecial thanks to the Metasploit team for creating another great CTF and congrats to team pepega and \u003ca href=\u0022https:\/\/twitter.com\/excusemewtf_ctf\u0022\u003eexcusemewtf\u003c\/a\u003e for taking the top spots!\u003c\/p\u003e\n\u003ch2 id=\u0022challenge\u0022\u003eChallenge\u003c\/h2\u003e\n\u003cp\u003eFirst, I browsed to port 80 and was met with this screen:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/images\/metasploit-ctf_2020\/port80.png\u0022 alt=\u002280\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eInteresting, I kicked off a \u003cstrong\u003egobuster\u003c\/strong\u003e scan but returned to find no results. The icon in the top left looked suspicious, so I loaded it directly.\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/images\/metasploit-ctf_2020\/ms_logo.png\u0022 alt=\u0022ms logo\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eWow, a QR code\u0026hellip;\u003c\/p\u003e\n\u003cp\u003eSPOILERS BELOW - The picture linked above is the exact image from the challenge, so feel free to give it a shot before reading the solution.\u003c\/p\u003e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-02-04 00:00:00 \u002b0000 UTC",
        "dateModified" : "2020-02-04 00:00:00 \u002b0000 UTC",
        "url" : "https:\/\/mike-boya.github.io\/post\/metasploitctf2020-queen-of-diamonds-write-up\/",
        "wordCount" : "661",
        "keywords" : [ "Blog" ]
    }
    </script>
        
            
                <title>Metasploit CTF 2020 - Queen Of Diamonds Write-Up</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.75.1" />
        
  
    
  

  

  <link rel="apple-touch-icon-precomposed" href='https://mike-boya.github.io/favicon/apple-touch-icon-precomposed.png'>
  <link rel="icon" href='https://mike-boya.github.io/favicon/favicon.png'>
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Mike Boya">
  <meta name="msapplication-tooltip" content="Information Security">
  <meta name="msapplication-config" content='/favicon/ieconfig.xml'>



        
        
            
                <meta name="description" content="Information Security">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Metasploit CTF 2020 - Queen Of Diamonds Write-Up"/>
<meta name="twitter:description" content="Intro
My team and I participated in the Metasploit CTF this past week and came in third place! I wanted to write up a solution for one of my favorite challenges.
Special thanks to the Metasploit team for creating another great CTF and congrats to team pepega and excusemewtf for taking the top spots!
Challenge
First, I browsed to port 80 and was met with this screen:

Interesting, I kicked off a gobuster scan but returned to find no results. The icon in the top left looked suspicious, so I loaded it directly.

Wow, a QR code&hellip;
SPOILERS BELOW - The picture linked above is the exact image from the challenge, so feel free to give it a shot before reading the solution."/>
<meta name="twitter:site" content="@mikeboya"/>

        <meta property="og:title" content="Metasploit CTF 2020 - Queen Of Diamonds Write-Up" />
<meta property="og:description" content="Intro
My team and I participated in the Metasploit CTF this past week and came in third place! I wanted to write up a solution for one of my favorite challenges.
Special thanks to the Metasploit team for creating another great CTF and congrats to team pepega and excusemewtf for taking the top spots!
Challenge
First, I browsed to port 80 and was met with this screen:

Interesting, I kicked off a gobuster scan but returned to find no results. The icon in the top left looked suspicious, so I loaded it directly.

Wow, a QR code&hellip;
SPOILERS BELOW - The picture linked above is the exact image from the challenge, so feel free to give it a shot before reading the solution." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mike-boya.github.io/post/metasploitctf2020-queen-of-diamonds-write-up/" />
<meta property="article:published_time" content="2020-02-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-02-04T00:00:00+00:00" />

        <meta property="og:image" content="https://mike-boya.github.io//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Metasploit CTF 2020 - Queen Of Diamonds Write-Up">
<meta itemprop="description" content="Intro
My team and I participated in the Metasploit CTF this past week and came in third place! I wanted to write up a solution for one of my favorite challenges.
Special thanks to the Metasploit team for creating another great CTF and congrats to team pepega and excusemewtf for taking the top spots!
Challenge
First, I browsed to port 80 and was met with this screen:

Interesting, I kicked off a gobuster scan but returned to find no results. The icon in the top left looked suspicious, so I loaded it directly.

Wow, a QR code&hellip;
SPOILERS BELOW - The picture linked above is the exact image from the challenge, so feel free to give it a shot before reading the solution.">
<meta itemprop="datePublished" content="2020-02-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-02-04T00:00:00+00:00" />
<meta itemprop="wordCount" content="661">



<meta itemprop="keywords" content="" />

        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="https://mike-boya.github.io/css/main.css">
            <link rel="stylesheet" href="https://mike-boya.github.io/css/add-on.css">
            <link rel="stylesheet" href="https://mike-boya.github.io/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-64695407-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="https://mike-boya.github.io/">post</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="https://mike-boya.github.io/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/about/">
                            <i class="fa fa-id-card-o">&nbsp;</i>About
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/post/">
                            <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/itemized/">
                            <i class="fa fa-list">&nbsp;</i>Itemized
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/categories/">
                            <i class="fa fa-sitemap">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/contact/">
                            <i class="fa fa-envelope-o">&nbsp;</i>Contact
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="https://mike-boya.github.io/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="https://mike-boya.github.io/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="https://mike-boya.github.io/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/about/">
                            <h3>
                                <i class="fa fa-id-card-o">&nbsp;</i>About
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/post/">
                            <h3>
                                <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/itemized/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Itemized
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/categories/">
                            <h3>
                                <i class="fa fa-sitemap">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/contact/">
                            <h3>
                                <i class="fa fa-envelope-o">&nbsp;</i>Contact
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/">Post</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-01'>
                                    October 1, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/synology-pushover-notifications/">Synology Pushover Notifications </a></h3>
                                
                                <time class="published" datetime=
                                    '2020-10-01'>
                                    October 1, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/metasploitctf2020-queen-of-diamonds-write-up/">Metasploit CTF 2020 - Queen Of Diamonds Write-Up</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-02-04'>
                                    February 4, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/sans-holiday-challenge-2018-writeup/">SANS Holiday Challenge 2018 - Writeup</a></h3>
                                
                                <time class="published" datetime=
                                    '2019-01-17'>
                                    January 17, 2019</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/googlectf-spotted-quoll-write-up/">GoogleCTF - Spotted Quoll Write-Up</a></h3>
                                
                                <time class="published" datetime=
                                    '2016-05-01'>
                                    May 1, 2016</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /post/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="//twitter.com/share?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fmetasploitctf2020-queen-of-diamonds-write-up%2f&amp;text=Metasploit%20CTF%202020%20-%20Queen%20Of%20Diamonds%20Write-Up&amp;via=mikeboya" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>










<li>
  <a href="//reddit.com/submit?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fmetasploitctf2020-queen-of-diamonds-write-up%2f&amp;title=Metasploit%20CTF%202020%20-%20Queen%20Of%20Diamonds%20Write-Up" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fmetasploitctf2020-queen-of-diamonds-write-up%2f&amp;title=Metasploit%20CTF%202020%20-%20Queen%20Of%20Diamonds%20Write-Up" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="https://mike-boya.github.io/post/metasploitctf2020-queen-of-diamonds-write-up/">Metasploit CTF 2020 - Queen Of Diamonds Write-Up</a></h1>
            
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2020-02-04'>
            February 4, 2020</time>
        <span class="author"></span>
        
            <p>4 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="//twitter.com/share?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fmetasploitctf2020-queen-of-diamonds-write-up%2f&amp;text=Metasploit%20CTF%202020%20-%20Queen%20Of%20Diamonds%20Write-Up&amp;via=mikeboya" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>










<li>
  <a href="//reddit.com/submit?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fmetasploitctf2020-queen-of-diamonds-write-up%2f&amp;title=Metasploit%20CTF%202020%20-%20Queen%20Of%20Diamonds%20Write-Up" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fmetasploitctf2020-queen-of-diamonds-write-up%2f&amp;title=Metasploit%20CTF%202020%20-%20Queen%20Of%20Diamonds%20Write-Up" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











      </ul>
    </section>
  

  

  <div id="content">
    <h2 id="intro">Intro</h2>
<p>My team and I participated in the Metasploit CTF this past week and came in third place! I wanted to write up a solution for one of my favorite challenges.</p>
<p>Special thanks to the Metasploit team for creating another great CTF and congrats to team pepega and <a href="https://twitter.com/excusemewtf_ctf">excusemewtf</a> for taking the top spots!</p>
<h2 id="challenge">Challenge</h2>
<p>First, I browsed to port 80 and was met with this screen:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/port80.png" alt="80"></p>
<p>Interesting, I kicked off a <strong>gobuster</strong> scan but returned to find no results. The icon in the top left looked suspicious, so I loaded it directly.</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/ms_logo.png" alt="ms logo"></p>
<p>Wow, a QR code&hellip;</p>
<p>SPOILERS BELOW - The picture linked above is the exact image from the challenge, so feel free to give it a shot before reading the solution.</p>
<h2 id="solution">Solution</h2>
<p>I cleaned up the QR code with <strong>gimp</strong> in order to scan it.</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/cleaned_qr.png" alt="cleaned QR"></p>
<p>Now, time to scan. I used <a href="https://zxing.org/w/decode.jspx">zxing</a>:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/qr_decode.png" alt="zxing"></p>
<p>Well, that&rsquo;s no flag. However, this output reminded us of a similar message we encountered during the initial enumeration of the box.</p>
<p>During the initial enumeration we ran a full <strong>nmap</strong> scan:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/nmap_all_ports.png" alt="Nmap"></p>
<p>We saw port 1994 open, so we ran some quick tests against it:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/1994.png" alt="Port 1994"></p>
<p>See, this also mentions a cigar. I did attempt to submit the QR code and full ms_logo to the port with <strong>nc</strong> but no luck. I started analyzing the ms_logo image with a number of Stego tools, but wasn&rsquo;t getting any usable results. However, that band of color in the top left corner kept bothering me. I took a closer look with <strong>gimp</strong>:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/color-band.png" alt="Color Band"></p>
<p>Then, I wrote a small Python script to print out those unique pixels:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image

im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;ms_logo.png&#39;</span>)
rgb_im <span style="color:#f92672">=</span> im<span style="color:#f92672">.</span>convert(<span style="color:#e6db74">&#39;RGB&#39;</span>)

<span style="color:#75715e">#print(&#39;width: &#39;, im.width)</span>
<span style="color:#75715e">#print(&#39;height:&#39;, im.height)</span>

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(im<span style="color:#f92672">.</span>height):
  r,g,b <span style="color:#f92672">=</span> im<span style="color:#f92672">.</span>getpixel((<span style="color:#ae81ff">13</span>,i))
  <span style="color:#66d9ef">if</span> r <span style="color:#f92672">!=</span> b <span style="color:#f92672">and</span> b <span style="color:#f92672">!=</span> g:
    <span style="color:#66d9ef">print</span>(r,g,b)</code></pre></div>
<p>Here are the results:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python3 color-column.py | head -n <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">244</span> <span style="color:#ae81ff">243</span> <span style="color:#ae81ff">246</span>
<span style="color:#ae81ff">248</span> <span style="color:#ae81ff">246</span> <span style="color:#ae81ff">255</span>
<span style="color:#ae81ff">246</span> <span style="color:#ae81ff">255</span> <span style="color:#ae81ff">247</span></code></pre></div>
<p>Now, I don&rsquo;t want anyone reading this post to think I instantly recognized this. I had a suspicion that Least Significant Bit (LSB) stego was a possibility, but I stared at these numbers for awhile and even jumped to other challenges. Finally, I came back and took a look with CyberChef:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/cyberchef_lsb_analysis.png" alt="LSB Analysis"></p>
<p>I see a pattern here. Let me illustrate it a little better:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/lsb.png" alt="LSB"></p>
<p>The least significant bits, four to be exact, are changing. I wrote a Python script to pull these out:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python3</span>

<span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image

im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;ms_logo.png&#39;</span>)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">65</span>):
    pix <span style="color:#f92672">=</span> im<span style="color:#f92672">.</span>getpixel((<span style="color:#ae81ff">13</span>,i))
    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">3</span>):
      <span style="color:#66d9ef">print</span>(bin(pix[n])[<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:],end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>)</code></pre></div>
<p>Here is the output after running the tool:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ python3 colors.py
<span style="color:#ae81ff">010000110110100001101111011011110111001101100101001000000100110001101001011001100110010100101110001000000100001001110101011101000010000001110111011010000111100100100000011101110110111101110101011011000110010000100000010010010010000001110111011000010110111001110100001000000111010001101111001000000110010001101111001000000110000100100000011101000110100001101001011011100110011100100000011011000110100101101011011001010010000001110100011010000110000101110100001000000111011101101000011001010110111000100000010010010010000001101000011000010111011001100101001000000110100001100001011000110110101101101001011011100110011100111111</span></code></pre></div>
<p>I collected the binary and ran it through CyberChef:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/cyberchef_binary_decode.png" alt="CyberChef Binary Decode"></p>
<p>That looks like what we have been searching for! Moving back to the port I mentioned earlier, I tried submitting the string:</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/1994_submission.png" alt="Phrase Submission"></p>
<p>As you can see, it confirms we cracked the code and sends flag data. I redirected this information to a file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ echo -n <span style="color:#e6db74">&#34;Choose Life. But why would I want to do a thing like that when I have hacking?&#34;</span> | nc 172.16.1.101 <span style="color:#ae81ff">1994</span> &gt; qr.txt</code></pre></div>
<p>I opened it in <strong>vim</strong> and deleted the top two lines. The image did open and display fine, but I ran a quick run with <strong>pngcheck</strong> to verify the file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ pngcheck qr.png
qr.png  additional data after IEND chunk
ERROR: qr.png</code></pre></div>
<p>Luckily, I have seen this before:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">xxd qr.png | tail -n <span style="color:#ae81ff">5</span>
0000a7e0: <span style="color:#ae81ff">3734</span> 6dda <span style="color:#ae81ff">1484</span> 481f 3db7 d4f9 8bd9 d851  74m...H.<span style="color:#f92672">=</span>......Q
0000a7f0: 5c5c 8cfd fbf7 e3f8 f1e3 <span style="color:#ae81ff">2829</span> f12c fa05  <span style="color:#ae81ff">\\</span>........<span style="color:#f92672">()</span>.,..
0000a800: <span style="color:#ae81ff">1144</span> 10be <span style="color:#ae81ff">0741</span> <span style="color:#ae81ff">1048</span> 4d4d 45fb f6ed 45d9  .D...A.HMME...E.
0000a810: ce88 c1ff <span style="color:#ae81ff">0102</span> <span style="color:#ae81ff">5199</span> 95f0 4bd1 1e00 <span style="color:#ae81ff">0000</span>  ......Q...K.....
0000a820: <span style="color:#ae81ff">0049</span> 454e 44ae <span style="color:#ae81ff">4260</span> 820a                 .IEND.B<span style="color:#e6db74">`</span>..
</code></pre></div><p>This is a quick fix. I opened the png in a hex editor and deleted the trailing 0a.</p>
<p>Now it should pass the check:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ pngcheck queen_of_diamonds.png
OK: queen_of_diamonds.png <span style="color:#f92672">(</span>283x378, 32-bit RGB+alpha, non-interlaced, 89.9%<span style="color:#f92672">)</span>.</code></pre></div>
<p>After making these modifications, we can view the final flag!</p>
<p><img src="https://mike-boya.github.io/images/metasploit-ctf_2020/queen_of_diamonds.png" alt="Queen of Diamonds"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ queen_of_diamonds.png
MD5 <span style="color:#f92672">(</span>queen_of_diamonds.png<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> 01880728bf92ae2570ce3c0cd4b01d8b</code></pre></div>
<p>Thanks for reading!</p>
  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="https://mike-boya.github.io/categories/ctf">CTF</a></li>
                
                
                <li><a class="article-category-link" href="https://mike-boya.github.io/categories/stego">Stego</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-mike-boya-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="https://mike-boya.github.io/post/sans-holiday-challenge-2018-writeup/"
                class="button big previous">SANS Holiday Challenge 2018 - Writeup</a></li>
    

    
        <li><a href="https://mike-boya.github.io/post/synology-pushover-notifications/"
                class="button big next">Synology Pushover Notifications </a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='https://mike-boya.github.io/'><img src="https://mike-boya.github.io/images/logo.jpg" class="intro-circle" width="" alt="Logo" /></a>
      
    
    
      <header>
        <h2>Mike Boya</h2>
        <p>Infosec Blog</p>
      </header>
    
    
      <ul class="icons">
        
        
  <li><a href="//github.com/mike-boya" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/mike-boya-a444a927" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>



































  <li><a href="//twitter.com/mikeboya" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/">Post</a>
              </h3>
              
              <time class="published" datetime='2020-10-01'>
                October 1, 2020
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/synology-pushover-notifications/">Synology Pushover Notifications </a>
              </h3>
              
              <time class="published" datetime='2020-10-01'>
                October 1, 2020
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/metasploitctf2020-queen-of-diamonds-write-up/">Metasploit CTF 2020 - Queen Of Diamonds Write-Up</a>
              </h3>
              
              <time class="published" datetime='2020-02-04'>
                February 4, 2020
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/sans-holiday-challenge-2018-writeup/">SANS Holiday Challenge 2018 - Writeup</a>
              </h3>
              
              <time class="published" datetime='2019-01-17'>
                January 17, 2019
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/googlectf-spotted-quoll-write-up/">GoogleCTF - Spotted Quoll Write-Up</a>
              </h3>
              
              <time class="published" datetime='2016-05-01'>
                May 1, 2016
              </time>
            </header>
            

          </article>
        
      </div>

      
        <a href=
          
            /post/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="https://mike-boya.github.io/categories/">Categories</a>
        </h3>
      </header>
        
          
        

        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/exploit-exercises/">exploit-exercises</a>
                <span style="float:right;">20</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/ctf/">ctf</a>
                <span style="float:right;">4</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/sans-holiday-hack/">sans-holiday-hack</a>
                <span style="float:right;">2</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/homelab/">homelab</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/offensive-security/">offensive-security</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/oscp/">oscp</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/stego/">stego</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/synology/">synology</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
    </section>
  
  

  
  

  
  <section id="footer">
    
      <ul class="icons">
        
        
  <li><a href="//github.com/mike-boya" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/mike-boya-a444a927" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>



































  <li><a href="//twitter.com/mikeboya" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
    <p class="copyright">
      
        &copy; 2020
        
          Mike Boya
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="https://mike-boya.github.io/js/util.js"></script>
      <script src="https://mike-boya.github.io/js/main.js"></script>
      <script src="https://mike-boya.github.io/js/backToTop.js"></script>
    

    
      
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

